<!DOCTYPE html>
<html>
<head>
  <title>eWAY Payment Form</title>
  <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
  <script src="https://secure.ewaypayments.com/scripts/eCrypt.min.js"></script>
  <link rel="icon" href="data:,">
</head>
<body>

  <div id="info"></div>

  <form data-eway-encrypt-key="09n/nrZ2RtlG9HWIuWmDq+w/KIv5E4BJwP413gyPZ5xnRFf6HvgS8P5q478oLsYQji+b2TuJVBdxRurAl6qZWioRjbI4uG2VAzxsuX5bnK8TkmU15MSZkSWd9m4wFYjnIFMkxbCPhKHOzwrVz7fZcxckY1d1is3K2D8J7NnDv3WmTxmYKnJkHZwxdeD7XgSCThcexrTJZEYBlaYftHbxfEOVHvcj4Cu1zKPcQfn+ZWlITm/QEjqgZHov957LeavJOhpzcGJAkK8X4o6W99PcQbj277Tus+S3qQsd7miz+H5dObjUSz7w/b7EMaD4GecVgKm18zdCoOraN3Cs3ON3nQ==">
    <label>Card Name</label>
    <input type="text" id="card_name" placeholder="John Doe" />
    
    <label>Card Number</label>
    <input type="text" id="card_number" placeholder="4444333322221111" />

    <label>CVV</label>
    <input type="text" id="card_cvn" placeholder="123" />

    <label>Expiry Month</label>
    <input type="text" id="expiry_month" placeholder="09" />

    <label>Expiry Year</label>
    <input type="text" id="expiry_year" placeholder="25" />

    <input type="button" id="submit" value="Make Payment" />
  </form>

  <script type="text/javascript">
    $(document).ready(function () {
      $('#submit').click(function () {
        const cardName = $('#card_name').val();
        const cardNumber = $('#card_number').val();
        const cardCVN = $('#card_cvn').val();
        const expiryMonth = $('#expiry_month').val();
        const expiryYear = $('#expiry_year').val();

        if (typeof eCrypt.encryptValue !== 'function') {
          alert('Encryption library not loaded.');
          return;
        }

        if (!cardNumber) {
          alert('Card number is empty!');
          return;
        }

        const encryptedData = {
          card_name: cardName, 
          card_number: eCrypt.encryptValue(cardNumber),
          card_cvn: eCrypt.encryptValue(cardCVN),
          card_expiry_month: eCrypt.encryptValue(expiryMonth),
          card_expiry_year: eCrypt.encryptValue(expiryYear)
        };

        $.ajax({
          url: 'https:api.tradehunters.com.au/api/eway/pay', 
          type: 'POST',
          contentType: 'application/json',
          data: JSON.stringify(encryptedData),
          success: function (data) {
            $('#info').html(`<pre>${JSON.stringify(data, null, 2)}</pre>`);
          },
          error: function (xhr) {
            $('#info').html('Error: ' + xhr.responseText);
          }
        });
      });
    });
  </script>

</body>
</html>
